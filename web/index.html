<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSS Curator</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
    <div id="app">
        <div class="toast-container">
            <div 
                v-for="toast in toasts" 
                :key="toast.id"
                :class="['toast', `toast-${toast.type}`]"
            >
                {{ toast.message }}
            </div>
        </div>

        <div class="container">
            <header class="header">
                <h1>ðŸ“¡ RSS Curator</h1>
                <div class="header-stats">
                    <div class="stat">
                        <span class="label">Pending</span>
                        <span class="value">{{ pendingCount }}</span>
                    </div>
                    <div class="stat">
                        <span class="label">Approved</span>
                        <span class="value">{{ approvedCount }}</span>
                    </div>
                    <div class="stat">
                        <span class="label">Rejected</span>
                        <span class="value">{{ rejectedCount }}</span>
                    </div>
                </div>
            </header>

            <main class="main">
                <div class="controls">
                    <div class="filter-tabs">
                        <button 
                            v-for="tab in tabs" 
                            :key="tab"
                            @click="activeTab = tab"
                            :class="['tab', { active: activeTab === tab }]"
                        >
                            {{ tab }}
                        </button>
                    </div>
                    <div v-if="selectedCount > 0" class="bulk-actions">
                        <span class="selection-info">{{ selectedCount }} selected</span>
                        <button 
                            @click="bulkApprove" 
                            class="btn btn-success"
                            :disabled="bulkLoading"
                        >
                            <span v-if="bulkLoading" class="spinner"></span>
                            {{ bulkLoading ? 'Approving...' : 'Approve Selected' }}
                        </button>
                        <button 
                            @click="bulkReject" 
                            class="btn btn-danger"
                            :disabled="bulkLoading"
                        >
                            <span v-if="bulkLoading" class="spinner"></span>
                            {{ bulkLoading ? 'Rejecting...' : 'Reject Selected' }}
                        </button>
                    </div>
                </div>

                <div v-if="loading" class="loading">
                    <p>Loading torrents...</p>
                </div>

                <div v-else-if="displayedTorrents.length === 0" class="empty-state">
                    <p>No {{ activeTab }} torrents</p>
                </div>

                <div v-else class="torrents-grid">
                    <div 
                        v-for="torrent in displayedTorrents" 
                        :key="torrent.id"
                        class="torrent-card"
                    >
                        <div class="card-header">
                            <input 
                                v-if="activeTab === 'pending'"
                                type="checkbox" 
                                :checked="isSelected(torrent.id)"
                                @change="toggleSelection(torrent.id)"
                                class="checkbox"
                            >
                            <span class="status-badge" :class="`status-${torrent.status}`">
                                {{ torrent.status }}
                            </span>
                        </div>
                        
                        <h3 class="torrent-title">{{ torrent.title }}</h3>
                        
                        <div class="torrent-details">
                            <span class="detail-item">
                                <span class="label">Size:</span>
                                <span class="value">{{ formatSize(torrent.size) }}</span>
                            </span>
                            <span class="detail-item">
                                <span class="label">Match:</span>
                                <span class="value">{{ torrent.match_reason }}</span>
                            </span>
                        </div>
                        
                        <div v-if="activeTab === 'pending'" class="card-actions">
                            <button 
                                @click="approveTorrent(torrent.id)" 
                                class="btn btn-success"
                                :disabled="operatingIds.has(torrent.id)"
                            >
                                <span v-if="operatingIds.has(torrent.id)" class="spinner"></span>
                                {{ operatingIds.has(torrent.id) ? '' : 'Approve' }}
                            </button>
                            <button 
                                @click="rejectTorrent(torrent.id)" 
                                class="btn btn-danger"
                                :disabled="operatingIds.has(torrent.id)"
                            >
                                <span v-if="operatingIds.has(torrent.id)" class="spinner"></span>
                                {{ operatingIds.has(torrent.id) ? '' : 'Reject' }}
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
